<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CometChat Demo</title>
</head>
<body style="margin: 0; padding: 0; background-color: #ffffff;">

    <div id="cometchat-container" style="width: 100%; height: 100vh;"></div>

    <script src="https://cdn.jsdelivr.net/npm/@cometchat/chat-embed@latest/dist/main.js"></script>

    <script>
        window.addEventListener('load', function() {
            const checkSDK = setInterval(() => {
                if (window.CometChatWidget) {
                    clearInterval(checkSDK);
                    setupChat();
                }
            }, 200);
        });

        async function setupChat() {
            const appID = "16690658bf8acd328"; 
            const region = "eu"; 
            const authKey = "0a2c73baa5e4a8bb0858f4e97963328839e97436";
            const uid = "rossmackenzie"; 

            try {
                // 1. Initialize
                await CometChatWidget.init({ appID, appRegion: region, authKey });
                console.log("Init Success");

                // 2. Short pause to let internal 'mf.js' params settle
                await new Promise(res => setTimeout(res, 500));

                // 3. Login
                await CometChatWidget.login({ uid });
                console.log("Login Success");

                // 4. Launch
                CometChatWidget.launch({
                    targetElementID: "cometchat-container",
                    docked: false,
                    height: "100%",
                    width: "100%",
                });
            } catch (error) {
                console.error("Chat Setup Error:", error);
            }
        }
    </script>
</body>
</html>